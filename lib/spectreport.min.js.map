{"version":3,"sources":["spectreport.min.js","spectreport.js"],"names":["_createClass","require","_classCallCheck","_Object$assign","_Object$getOwnPropertyNames","_getIterator","global","factory","exports","module","define","amd","spectreport","this","Stats","tests","arguments","length","undefined","pending","failures","duration","timeStart","timeStop","key","value","stats","obj","crypto","Test","test","status","err","_this","title","String","fullTitle","Math","round","error","forEach","get","createHash","update","JSON","stringify","digest","fakeTest","TEST_PENDING","TEST_PASS","TEST_FAIL","Suite","suite","parent","file","suites","add","hasTests","push","addStats","Date","now","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","next","done","copy","fromObject","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","child","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","_fs","_path","Aggregator","jsonDir","suiteTitle","results","lookupKeyPaths","fileList","files","readdirSync","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_step4","_iterator4","join","statSync","isDirectory","listFiles","indexOf","keyPath","jsonObj","lookup","cursor","addSuite","fixTimeStats","pop","_iteratorNormalCompletion5","_didIteratorError5","_iteratorError5","_step5","_iterator5","dir","relative","dirname","split","sep","shift","readJsonSync","addJsonObject","ex","Error","message","addJsonFileList","fs","jade","path","defaults","outputHtml","template","__dirname","Spectreport","opts","aggregator","scan","reportHtml","renderFile","pretty","report","writeFileSync","DefaultOptions"],"mappings":"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","file":"spectreport.min.js","sourcesContent":[null,"(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n    typeof define === 'function' && define.amd ? define(factory) :\n    global.spectreport = factory();\n}(this, function () { 'use strict';\n\n    class Stats {\n        constructor(tests = 0, pending = 0, failures = 0, duration = 0) {\n            this.tests = tests;\n            this.pending = pending;\n            this.failures = failures;\n            this.duration = duration;\n            this.timeStart = null;\n            this.timeStop = null;\n        }\n        add(stats) {\n            this.tests += stats.tests;\n            this.pending += stats.pending;\n            this.failures += stats.failures;\n        }\n        static fromObject(obj) {\n            let stats = new Stats();\n            return Object.assign(stats, obj);\n        }\n    }\n\n    const crypto = require('crypto');\n\n    class Test {\n        constructor(test, status, err) {\n            this.status = status;\n            this.title = String(test.title);\n            this.fullTitle = test.fullTitle();\n            this.duration = Math.round(test.duration / 10) / 100;\n            this.error = null;\n\n            if(err) {\n                this.error = {};\n                Object.getOwnPropertyNames(err).forEach(key => {\n                    this.error[key] = err[key];\n                });\n            }\n        }\n        get hash() {\n            return crypto.createHash('sha1').update(JSON.stringify(this)).digest('hex');\n        }\n        static fromObject(obj) {\n            // Construct faux test object\n            let fakeTest = {\n                fullTitle: () => { return null; }\n            };\n\n            if(obj.error === undefined || obj.error === null) {\n                delete obj.error;\n            }\n\n            let test = new Test(fakeTest);\n            return Object.assign(test, obj);\n        }\n    }\n\n    Test.TEST_PENDING = 2;\n    Test.TEST_PASS = 1;\n    Test.TEST_FAIL = 0;\n\n    class Suite {\n        constructor(suite, parent) {\n            this.title = suite.title;\n            this.file = suite.file;\n            this.suites = [];\n            this.tests = [];\n            this.parent = parent;\n            this.stats = new Stats();\n        }\n        addStats(stats) {\n            this.stats.add(stats);\n        }\n        addSuite(suite) {\n            if (!suite.hasTests()) {\n                return false;\n            }\n            this.suites.push(suite);\n            this.addStats(suite.stats);\n        }\n        addTest(test) {\n            this.tests.push(test);\n            this.stats.tests++;\n\n            if (test.status === Test.TEST_PENDING) {\n                this.stats.pending++;\n            }\n            else if (test.status === Test.TEST_FAIL) {\n                this.stats.failures++;\n            }\n        }\n        hasTests() {\n            return (this.stats.tests > 0);\n        }\n        start(timeStart) {\n            this.stats.timeStart = timeStart || Date.now();\n        }\n        stop(timeStop, duration) {\n            if(!duration && !this.stats.timeStart > 0) {\n                return false;\n            }\n            this.stats.timeStop = timeStop || Date.now();\n            this.stats.duration = duration || Math.round((this.stats.timeStop - this.stats.timeStart) / 10) / 100;\n        }\n        fixTimeStats() {\n            for (let suite of this.suites) {\n                if (this.stats.timeStart === null || this.stats.timeStart > suite.stats.timeStart) {\n                    this.stats.timeStart = suite.stats.timeStart;\n                }\n                if (this.stats.timeStop === null || this.stats.timeStop < suite.stats.timeStop) {\n                    this.stats.timeStop = suite.stats.timeStop;\n                }\n                this.stats.duration = Math.round((this.stats.timeStop - this.stats.timeStart) / 10) / 100;\n            }\n        }\n        toJSON() {\n            // Generate a clean, shallow copy without the parent\n            let copy = {\n                title: this.title,\n                file: this.file,\n                suites: this.suites,\n                tests: this.tests,\n                stats: this.stats\n            };\n\n            return copy;\n        }\n        static fromObject(obj, parent) {\n\n            let suite = new Suite(obj, parent);\n            let suites = [];\n            let tests = [];\n            let stats = null;\n\n            stats = Stats.fromObject(obj.stats);\n            Object.assign(suite, {stats: stats});\n\n            for (let child of obj.suites) {\n                suites.push(Suite.fromObject(child, suite));\n            }\n            Object.assign(suite, {suites: suites});\n\n            for (let test of obj.tests) {\n                tests.push(Test.fromObject(test));\n            }\n            Object.assign(suite, {tests: tests});\n\n            return suite;\n        }\n    }\n\n    const _fs = require('fs-extra');\n    const _path = require('path');\n\n    class Aggregator {\n        constructor(jsonDir, suiteTitle) {\n            this.jsonDir = jsonDir;\n            this.results = new Suite({title: suiteTitle});\n            this.lookupKeyPaths = {};\n        }\n\n        // List all files in a directory in Node.js recursively in a synchronous fashion\n        listFiles(jsonDir, fileList) {\n            jsonDir = jsonDir || this.jsonDir;\n            fileList = fileList || [];\n\n            let files = _fs.readdirSync(jsonDir);\n\n            for(let file of files) {\n                file = _path.join(jsonDir, file);\n                if (_fs.statSync(file).isDirectory()) {\n                    fileList = this.listFiles(file, fileList);\n                } else if (file.indexOf('.json') > 0) {\n                    fileList.push(file);\n                }\n            }\n\n            return fileList;\n        }\n\n        addJsonObject(keyPath, jsonObj) {\n            let lookup = this.lookupKeyPaths,\n                suite = Suite.fromObject(jsonObj),\n                cursor = suite,\n                parent;\n\n            while (keyPath.length) {\n                parent = lookup[keyPath.join('|')];\n\n                if (!parent) {\n                    let key = keyPath[keyPath.length - 1];\n                    parent = new Suite({title: key});\n                    lookup[keyPath.join('|')] = parent;\n                }\n\n                if (cursor.parent !== parent) {\n                    cursor.parent = parent;\n                    parent.addSuite(cursor);\n                } else {\n                    parent.addStats(suite.stats);\n                }\n\n                parent.fixTimeStats();\n                cursor = parent;\n                keyPath.pop();\n            }\n\n            parent = this.results;\n            if (cursor.parent !== parent) {\n                cursor.parent = parent;\n                parent.addSuite(cursor);\n            } else {\n                parent.addStats(suite.stats);\n            }\n            parent.fixTimeStats();\n        }\n\n        addJsonFileList(fileList) {\n            for (let file of fileList) {\n                let dir = _path.relative(this.jsonDir, _path.dirname(file));\n                let keyPath = dir.split(_path.sep);\n                let jsonObj = null;\n\n                // Delete empty keyPath, occurs for top level tests.\n                if (keyPath[0] === '') {\n                    keyPath.shift();\n                }\n\n                try {\n                    jsonObj = _fs.readJsonSync(file);\n                    this.addJsonObject(keyPath, jsonObj);\n                } catch (ex) {\n                    throw new Error('There was a problem reading a results file: ' + file + '.\\n' + ex.message);\n                }\n            }\n        }\n\n        scan() {\n            let fileList = null;\n\n            try {\n                fileList = this.listFiles();\n            } catch (ex) {\n                throw new Error('There was a problem reading the results directory.\\n' + ex.message);\n            }\n\n            this.addJsonFileList(fileList);\n            return this.results;\n        }\n    }\n\n    const fs = require('fs-extra');\n    const jade = require('jade');\n    const path = require('path');\n\n    const defaults = {\n        outputHtml: 'test/results/index.html',\n        jsonDir: 'test/results',\n        template: path.join(path.relative('.', __dirname), 'assets/results.jade'),\n        suiteTitle: 'Test Results'\n    };\n\n    class Spectreport {\n        constructor(opts) {\n            this.results = null;\n            this.opts = Object.assign({}, defaults, opts);\n            this.aggregator = new Aggregator(this.opts.jsonDir, this.opts.suiteTitle);\n        }\n\n        scan() {\n            try {\n                this.results = this.aggregator.scan();\n            } catch (ex) {\n                ex.message = 'There was a problem aggregating the JSON results.\\n' + ex.message;\n                throw ex;\n            }\n\n            if (!this.results || !this.results.stats) {\n                throw new Error('No results were found.  Did you run the tests?');\n            }\n        }\n\n        report() {\n            if(!this.results) {\n                this.scan();\n            }\n\n            try {\n                this.reportHtml = jade.renderFile(this.opts.template, { pretty: true, results: this.results });\n            } catch (ex) {\n                ex.message = 'There was a problem rendering the HTML report.\\n' + ex.message;\n                throw ex;\n            }\n        }\n\n        output(outputHtml) {\n            if(!this.reportHtml) {\n                this.report();\n            }\n\n            outputHtml = outputHtml || this.opts.outputHtml;\n\n            try {\n                fs.writeFileSync(outputHtml, this.reportHtml);\n            } catch (ex) {\n                ex.message = 'There was a problem outputting the HTML report to disk.\\n' + ex.message;\n                throw ex;\n            }\n        }\n\n        summary() {\n            if(!this.results) {\n                this.scan();\n            }\n\n            return this.results.stats;\n        }\n    }\n\n    Spectreport.Stats = Stats;\n    Spectreport.Suite = Suite;\n    Spectreport.Test = Test;\n    Spectreport.DefaultOptions = defaults;\n\n    return Spectreport;\n\n}));"],"sourceRoot":"/source/"}