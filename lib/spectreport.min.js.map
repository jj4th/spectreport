{"version":3,"sources":["spectreport.min.js","spectreport.js"],"names":["_createClass","require","_classCallCheck","_Object$assign","_Object$getOwnPropertyNames","_getIterator","global","factory","exports","module","define","amd","spectreport","this","Stats","tests","arguments","length","undefined","pending","failures","duration","timeStart","timeStop","key","value","stats","obj","crypto","Test","test","status","err","_this","title","String","fullTitle","Math","round","error","forEach","get","createHash","update","JSON","stringify","digest","fakeTest","TEST_PENDING","TEST_PASS","TEST_FAIL","Suite","suite","parent","suites","add","hasTests","push","addStats","Date","now","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","next","done","copy","fromObject","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","child","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","_fs","_path","Aggregator","jsonDir","suiteTitle","results","lookupKeyPaths","fileList","files","readdirSync","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_step4","_iterator4","file","join","statSync","isDirectory","listFiles","indexOf","keyPath","jsonObj","lookup","cursor","addSuite","fixTimeStats","pop","_iteratorNormalCompletion5","_didIteratorError5","_iteratorError5","_step5","_iterator5","dir","relative","dirname","split","sep","shift","readJsonSync","addJsonObject","ex","Error","message","addJsonFileList","fs","dot","path","defaults","outputHtml","template","__dirname","Spectreport","opts","aggregator","scan","tpl","readFileSync","render","reportHtml","report","writeFileSync","DefaultOptions"],"mappings":"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","file":"spectreport.min.js","sourcesContent":[null,"(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n    typeof define === 'function' && define.amd ? define(factory) :\n    global.spectreport = factory();\n}(this, function () { 'use strict';\n\n    class Stats {\n        constructor(tests = 0, pending = 0, failures = 0, duration = 0) {\n            this.tests = tests;\n            this.pending = pending;\n            this.failures = failures;\n            this.duration = duration;\n            this.timeStart = null;\n            this.timeStop = null;\n        }\n        add(stats) {\n            this.tests += stats.tests;\n            this.pending += stats.pending;\n            this.failures += stats.failures;\n        }\n        static fromObject(obj) {\n            let stats = new Stats();\n            return Object.assign(stats, obj);\n        }\n    }\n\n    const crypto = require('crypto');\n\n    class Test {\n        constructor(test, status, err) {\n            this.status = status;\n            this.title = String(test.title);\n            this.fullTitle = test.fullTitle();\n            this.duration = Math.round(test.duration / 10) / 100;\n            this.error = null;\n\n            if(err) {\n                this.error = {};\n                Object.getOwnPropertyNames(err).forEach(key => {\n                    this.error[key] = err[key];\n                });\n            }\n        }\n        get hash() {\n            return crypto.createHash('sha1').update(JSON.stringify(this)).digest('hex');\n        }\n        static fromObject(obj) {\n            // Construct faux test object\n            let fakeTest = {\n                fullTitle: () => { return null; }\n            };\n\n            if(obj.error === undefined || obj.error === null) {\n                delete obj.error;\n            }\n\n            let test = new Test(fakeTest);\n            return Object.assign(test, obj);\n        }\n    }\n\n    Test.TEST_PENDING = 2;\n    Test.TEST_PASS = 1;\n    Test.TEST_FAIL = 0;\n\n    class Suite {\n        constructor(suite, parent) {\n            this.title = suite.title;\n            this.suites = [];\n            this.tests = [];\n            this.parent = parent;\n            this.stats = new Stats();\n        }\n        addStats(stats) {\n            this.stats.add(stats);\n        }\n        addSuite(suite) {\n            if (!suite.hasTests()) {\n                return false;\n            }\n            this.suites.push(suite);\n            this.addStats(suite.stats);\n        }\n        addTest(test) {\n            this.tests.push(test);\n            this.stats.tests++;\n\n            if (test.status === Test.TEST_PENDING) {\n                this.stats.pending++;\n            }\n            else if (test.status === Test.TEST_FAIL) {\n                this.stats.failures++;\n            }\n        }\n        hasTests() {\n            return (this.stats.tests > 0);\n        }\n        start(timeStart) {\n            this.stats.timeStart = timeStart || Date.now();\n        }\n        stop(timeStop, duration) {\n            if(!duration && !this.stats.timeStart > 0) {\n                return false;\n            }\n            this.stats.timeStop = timeStop || Date.now();\n            this.stats.duration = duration || Math.round((this.stats.timeStop - this.stats.timeStart) / 10) / 100;\n        }\n        fixTimeStats() {\n            for (let suite of this.suites) {\n                if (this.stats.timeStart === null || this.stats.timeStart > suite.stats.timeStart) {\n                    this.stats.timeStart = suite.stats.timeStart;\n                }\n                if (this.stats.timeStop === null || this.stats.timeStop < suite.stats.timeStop) {\n                    this.stats.timeStop = suite.stats.timeStop;\n                }\n                this.stats.duration = Math.round((this.stats.timeStop - this.stats.timeStart) / 10) / 100;\n            }\n        }\n        toJSON() {\n            // Generate a clean, shallow copy without the parent\n            let copy = {\n                title: this.title,\n                suites: this.suites,\n                tests: this.tests,\n                stats: this.stats\n            };\n\n            return copy;\n        }\n        static fromObject(obj, parent) {\n\n            let suite = new Suite(obj, parent);\n            let suites = [];\n            let tests = [];\n            let stats = null;\n\n            stats = Stats.fromObject(obj.stats);\n            Object.assign(suite, {stats: stats});\n\n            for (let child of obj.suites) {\n                suites.push(Suite.fromObject(child, suite));\n            }\n            Object.assign(suite, {suites: suites});\n\n            for (let test of obj.tests) {\n                tests.push(Test.fromObject(test));\n            }\n            Object.assign(suite, {tests: tests});\n\n            return suite;\n        }\n    }\n\n    const _fs = require('fs-extra');\n    const _path = require('path');\n\n    class Aggregator {\n        constructor(jsonDir, suiteTitle) {\n            this.jsonDir = jsonDir;\n            this.results = new Suite({title: suiteTitle});\n            this.lookupKeyPaths = {};\n        }\n\n        // List all files in a directory in Node.js recursively in a synchronous fashion\n        listFiles(jsonDir, fileList) {\n            jsonDir = jsonDir || this.jsonDir;\n            fileList = fileList || [];\n\n            let files = _fs.readdirSync(jsonDir);\n\n            for(let file of files) {\n                file = _path.join(jsonDir, file);\n                if (_fs.statSync(file).isDirectory()) {\n                    fileList = this.listFiles(file, fileList);\n                } else if (file.indexOf('.json') > 0) {\n                    fileList.push(file);\n                }\n            }\n\n            return fileList;\n        }\n\n        addJsonObject(keyPath, jsonObj) {\n            let lookup = this.lookupKeyPaths,\n                suite = Suite.fromObject(jsonObj),\n                cursor = suite,\n                parent;\n\n            while (keyPath.length) {\n                parent = lookup[keyPath.join('|')];\n\n                if (!parent) {\n                    let key = keyPath[keyPath.length - 1];\n                    parent = new Suite({title: key});\n                    lookup[keyPath.join('|')] = parent;\n                }\n\n                if (cursor.parent !== parent) {\n                    cursor.parent = parent;\n                    parent.addSuite(cursor);\n                } else {\n                    parent.addStats(suite.stats);\n                }\n\n                parent.fixTimeStats();\n                cursor = parent;\n                keyPath.pop();\n            }\n\n            parent = this.results;\n            if (cursor.parent !== parent) {\n                cursor.parent = parent;\n                parent.addSuite(cursor);\n            } else {\n                parent.addStats(suite.stats);\n            }\n            parent.fixTimeStats();\n        }\n\n        addJsonFileList(fileList) {\n            for (let file of fileList) {\n                let dir = _path.relative(this.jsonDir, _path.dirname(file));\n                let keyPath = dir.split(_path.sep);\n                let jsonObj = null;\n\n                // Delete empty keyPath, occurs for top level tests.\n                if (keyPath[0] === '') {\n                    keyPath.shift();\n                }\n\n                try {\n                    jsonObj = _fs.readJsonSync(file);\n                    this.addJsonObject(keyPath, jsonObj);\n                } catch (ex) {\n                    throw new Error('There was a problem reading a results file: ' + file + '.\\n' + ex.message);\n                }\n            }\n        }\n\n        scan() {\n            let fileList = null;\n\n            try {\n                fileList = this.listFiles();\n            } catch (ex) {\n                throw new Error('There was a problem reading the results directory.\\n' + ex.message);\n            }\n\n            this.addJsonFileList(fileList);\n            return this.results;\n        }\n    }\n\n    const fs = require('fs-extra');\n    const dot = require('dot');\n    const path = require('path');\n\n    const defaults = {\n        outputHtml: 'test/results/index.html',\n        jsonDir: 'test/results',\n        template: path.join(path.relative('.', __dirname), 'assets/results.dot'),\n        suiteTitle: 'Test Results'\n    };\n\n    class Spectreport {\n        constructor(opts) {\n            this.results = null;\n            this.opts = Object.assign({}, defaults, opts);\n            this.aggregator = new Aggregator(this.opts.jsonDir, this.opts.suiteTitle);\n        }\n\n        scan() {\n            try {\n                this.results = this.aggregator.scan();\n            } catch (ex) {\n                ex.message = 'There was a problem aggregating the JSON results.\\n' + ex.message;\n                throw ex;\n            }\n\n            if (!this.results || !this.results.stats) {\n                throw new Error('No results were found.  Did you run the tests?');\n            }\n        }\n\n        report() {\n            if(!this.results) {\n                this.scan();\n            }\n\n            try {\n                let tpl = fs.readFileSync(this.opts.template);\n                let render = dot.template(tpl);\n                this.reportHtml = render(this.results);\n            } catch (ex) {\n                ex.message = 'There was a problem rendering the HTML report.\\n' + ex.message;\n                throw ex;\n            }\n        }\n\n        output(outputHtml) {\n            if(!this.reportHtml) {\n                this.report();\n            }\n\n            outputHtml = outputHtml || this.opts.outputHtml;\n\n            try {\n                fs.writeFileSync(outputHtml, this.reportHtml);\n            } catch (ex) {\n                ex.message = 'There was a problem outputting the HTML report to disk.\\n' + ex.message;\n                throw ex;\n            }\n        }\n\n        summary() {\n            if(!this.results) {\n                this.scan();\n            }\n\n            return this.results.stats;\n        }\n    }\n\n    Spectreport.Stats = Stats;\n    Spectreport.Suite = Suite;\n    Spectreport.Test = Test;\n    Spectreport.DefaultOptions = defaults;\n\n    return Spectreport;\n\n}));"],"sourceRoot":"/source/"}