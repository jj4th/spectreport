var _createClass=require("babel-runtime/helpers/create-class")["default"],_classCallCheck=require("babel-runtime/helpers/class-call-check")["default"],_Object$assign=require("babel-runtime/core-js/object/assign")["default"],_Object$getOwnPropertyNames=require("babel-runtime/core-js/object/get-own-property-names")["default"],_getIterator=require("babel-runtime/core-js/get-iterator")["default"];!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.spectreport=e()}(this,function(){"use strict";var t=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0],s=arguments.length<=1||void 0===arguments[1]?0:arguments[1],r=arguments.length<=2||void 0===arguments[2]?0:arguments[2],i=arguments.length<=3||void 0===arguments[3]?0:arguments[3];_classCallCheck(this,t),this.tests=e,this.pending=s,this.failures=r,this.duration=i,this.timeStart=null,this.timeStop=null}return _createClass(t,[{key:"add",value:function(t){this.tests+=t.tests,this.pending+=t.pending,this.failures+=t.failures}}],[{key:"fromObject",value:function(e){var s=new t;return _Object$assign(s,e)}}]),t}(),e=function(){function t(e,s,r){var i=this;_classCallCheck(this,t),this.status=s,this.title=String(e.title),this.fullTitle=e.fullTitle(),this.duration=Math.round(e.duration/10)/100,this.error=null,r&&(this.error={},_Object$getOwnPropertyNames(r).forEach(function(t){i.error[t]=r[t]}))}return _createClass(t,null,[{key:"fromObject",value:function(e){var s={fullTitle:function(){return null}};(void 0===e.error||null===e.error)&&delete e.error;var r=new t(s);return _Object$assign(r,e)}}]),t}();e.TEST_PENDING=2,e.TEST_PASS=1,e.TEST_FAIL=0;var s=function(){function s(e,r){_classCallCheck(this,s),this.title=e.title,this.suites=[],this.tests=[],this.parent=r,this.stats=new t}return _createClass(s,[{key:"addStats",value:function(t){this.stats.add(t)}},{key:"addSuite",value:function(t){return t.hasTests()?(this.suites.push(t),void this.addStats(t.stats)):!1}},{key:"addTest",value:function(t){this.tests.push(t),this.stats.tests++,t.status===e.TEST_PENDING?this.stats.pending++:t.status===e.TEST_FAIL&&this.stats.failures++}},{key:"hasTests",value:function(){return this.stats.tests>0}},{key:"start",value:function(t){this.stats.timeStart=t||Date.now()}},{key:"stop",value:function(t,e){return!e&&!this.stats.timeStart>0?!1:(this.stats.timeStop=t||Date.now(),void(this.stats.duration=e||Math.round((this.stats.timeStop-this.stats.timeStart)/10)/100))}},{key:"fixTimeStats",value:function(){var t=!0,e=!1,s=void 0;try{for(var r,i=_getIterator(this.suites);!(t=(r=i.next()).done);t=!0){var a=r.value;(null===this.stats.timeStart||this.stats.timeStart>a.stats.timeStart)&&(this.stats.timeStart=a.stats.timeStart),(null===this.stats.timeStop||this.stats.timeStop<a.stats.timeStop)&&(this.stats.timeStop=a.stats.timeStop),this.stats.duration=Math.round((this.stats.timeStop-this.stats.timeStart)/10)/100}}catch(n){e=!0,s=n}finally{try{!t&&i["return"]&&i["return"]()}finally{if(e)throw s}}}},{key:"toJSON",value:function(){var t={title:this.title,suites:this.suites,tests:this.tests,stats:this.stats};return t}}],[{key:"fromObject",value:function(r,i){var a=new s(r,i),n=[],u=[],o=null;o=t.fromObject(r.stats),_Object$assign(a,{stats:o});var l=!0,h=!1,c=void 0;try{for(var f,d=_getIterator(r.suites);!(l=(f=d.next()).done);l=!0){var m=f.value;n.push(s.fromObject(m,a))}}catch(v){h=!0,c=v}finally{try{!l&&d["return"]&&d["return"]()}finally{if(h)throw c}}_Object$assign(a,{suites:n});var p=!0,y=!1,g=void 0;try{for(var S,b=_getIterator(r.tests);!(p=(S=b.next()).done);p=!0){var j=S.value;u.push(e.fromObject(j))}}catch(v){y=!0,g=v}finally{try{!p&&b["return"]&&b["return"]()}finally{if(y)throw g}}return _Object$assign(a,{tests:u}),a}}]),s}(),r=require("fs-extra"),i=require("path"),a=function(){function t(e,r){_classCallCheck(this,t),this.jsonDir=e,this.results=new s({title:r}),this.lookupKeyPaths={}}return _createClass(t,[{key:"listFiles",value:function(t,e){t=t||this.jsonDir,e=e||[];var s=r.readdirSync(t),a=!0,n=!1,u=void 0;try{for(var o,l=_getIterator(s);!(a=(o=l.next()).done);a=!0){var h=o.value;h=i.join(t,h),r.statSync(h).isDirectory()?e=this.listFiles(h,e):h.indexOf(".json")>0&&e.push(h)}}catch(c){n=!0,u=c}finally{try{!a&&l["return"]&&l["return"]()}finally{if(n)throw u}}return e}},{key:"addJsonObject",value:function(t,e){for(var r=this.lookupKeyPaths,i=s.fromObject(e),a=i,n=void 0;t.length;){if(n=r[t.join("|")],!n){var u=t[t.length-1];n=new s({title:u}),r[t.join("|")]=n}a.parent!==n?(a.parent=n,n.addSuite(a)):n.addStats(i.stats),n.fixTimeStats(),a=n,t.pop()}n=this.results,a.parent!==n?(a.parent=n,n.addSuite(a)):n.addStats(i.stats),n.fixTimeStats()}},{key:"addJsonFileList",value:function(t){var e=!0,s=!1,a=void 0;try{for(var n,u=_getIterator(t);!(e=(n=u.next()).done);e=!0){var o=n.value,l=i.relative(this.jsonDir,i.dirname(o)),h=l.split(i.sep),c=null;try{c=r.readJsonSync(o),this.addJsonObject(h,c)}catch(f){throw new Error("There was a problem reading a results file: "+o+".\n"+f.message)}}}catch(d){s=!0,a=d}finally{try{!e&&u["return"]&&u["return"]()}finally{if(s)throw a}}}},{key:"scan",value:function(){var t=null;try{t=this.listFiles()}catch(e){throw new Error("There was a problem reading the results directory.\n"+e.message)}return this.addJsonFileList(t),this.results}}]),t}(),n=require("fs-extra"),u=require("dot"),o=require("path"),l={outputHtml:"test/results/index.html",jsonDir:"test/results",template:o.join(o.relative(".",__dirname),"assets/results.dot"),suiteTitle:"Test Results"},h=function(){function t(e){_classCallCheck(this,t),this.opts=_Object$assign({},l,e),this.aggregator=new a(this.opts.jsonDir,this.opts.suiteTitle)}return _createClass(t,[{key:"report",value:function e(){var e=null,t=this.aggregator.scan();if(!t||!t.stats)throw new Error("No results were found.  Did you run the tests?");try{this.results=t;var s=n.readFileSync(this.opts.template),r=u.template(s);e=r(t)}catch(i){throw i.message="There was a problem rendering the HTML report.\n"+i.message,i}return e}},{key:"reportFile",value:function(t){var e=this.report();t=t||this.opts.outputHtml;try{n.writeFileSync(t,e)}catch(s){throw s.message="There was a problem outputting the HTML report to disk.\n"+s.message,s}return!0}},{key:"summary",value:function(){if(!this.results||!this.results.stats)throw new Error("No results were found.  Did you run 'report()'?");return this.results.stats}}]),t}();return h.Stats=t,h.Suite=s,h.Test=e,h.DefaultOptions=l,h});
//# sourceMappingURL=spectreport.min.js.map